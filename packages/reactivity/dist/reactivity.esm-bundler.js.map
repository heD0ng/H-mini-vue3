{"version":3,"file":"reactivity.esm-bundler.js","sources":["../../shared/src/index.ts","../src/operations.ts","../src/effect.ts","../src/baseHandler.ts","../src/reactive.ts","../src/ref.ts"],"sourcesContent":["export const isObject = (data) => {\r\n    return data && typeof data === 'object';\r\n}\r\n\r\nexport const isEqual = (val, oldVal) => {\r\n    return val === oldVal;\r\n}\r\n\r\nexport const isArray = (val) => {\r\n    return Array.isArray(val)\r\n}\r\n\r\nexport const isFunction = (val) => {\r\n    return typeof val === 'function';\r\n}\r\nexport const isNumber = (val) => {\r\n    return typeof val === 'number';\r\n}\r\nexport const isString = (val) => {\r\n    return typeof val === 'string';\r\n}\r\n// 判断数组的索引\r\nexport const isIntegerKey = (key) => '' + parseInt(key) === key;\r\n\r\nexport const hasOwn = (target, key) => {\r\n    return Object.prototype.hasOwnProperty.call(target, key);\r\n}\r\n\r\nexport * from './shapeFlags';","// 操作符\r\nexport enum TrackOpTypes {\r\n    GET = 'get',\r\n    HAS = 'has',\r\n    ITERATE = 'iterate'\r\n}\r\n\r\nexport enum TriggerOpTypes {\r\n    SET = 'set',\r\n    ADD = 'add',\r\n    DELETE = 'delete',\r\n    CLEAR = 'clear'\r\n}","import { isArray, isIntegerKey } from './../../shared/src/index';\r\nimport {TriggerOpTypes} from './operations';\r\nlet activeEffect = null;\r\nlet effectList = []\r\n\r\n/**\r\n * \r\n * @param fn \r\n * @param options : {lazy: true}-lazy为true，默认不执行\r\n * @returns \r\n */\r\nconst createReactiveEffect = (fn, options) => {\r\n    return new ReactiveEffect(fn, options);\r\n}\r\nexport const effect = (fn, options:any = {}) => {\r\n    const effect = createReactiveEffect(fn, options);\r\n    if(!options.lazy){\r\n        effect.run();\r\n    }\r\n    \r\n    return effect;\r\n}\r\n\r\n\r\nclass ReactiveEffect {\r\n    fn: Function;\r\n    options: any;\r\n    deps: Array<any>;\r\n    constructor(fn, options){\r\n        this.fn = fn;\r\n        this.deps = []\r\n        this.options = options;\r\n    }\r\n    run() {\r\n        // state.a++: 避免递归收集\r\n        // 当前的实例effect\r\n        if(!effectList.includes(this)) {\r\n            try {\r\n                // 入栈\r\n                activeEffect = this;\r\n                effectList.push(activeEffect);\r\n                console.log(effectList);\r\n                // cleanActiveEffectDeps(activeEffect);\r\n                return this.fn()\r\n            } finally  {\r\n                // 出栈\r\n                effectList.pop()\r\n                activeEffect = effectList[effectList.length - 1] || null;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction cleanActiveEffectDeps(activeEffect) {\r\n    const {deps} = activeEffect;\r\n    for(const dep of deps) {\r\n        dep.delete(activeEffect)\r\n    }\r\n\r\n    activeEffect.deps.length = 0;\r\n}\r\n\r\nlet targetMap = new WeakMap();\r\nexport function track(target, key, type?) {\r\n    if(!activeEffect) return;\r\n\r\n    let depsMap = targetMap.get(target);\r\n    if(!depsMap) {\r\n        depsMap = new Map()\r\n        targetMap.set(target, depsMap);\r\n        \r\n    }\r\n    let effectSet = depsMap.get(key)\r\n    if(!effectSet) {\r\n        effectSet = new Set();\r\n        depsMap.set(key, effectSet);\r\n    }\r\n    if(!effectSet.has(activeEffect)){\r\n        effectSet.add(activeEffect);\r\n    }\r\n}\r\n/**\r\n * \r\n * @param target \r\n * @param key \r\n * @param type \r\n * @param value \r\n * @param oldVal \r\n * @returns \r\n * depsMap: {\r\n *  0: [e1, e2],\r\n *  length: [e2, e3]\r\n * }\r\n */\r\nexport const trigger = (target, key, type='get', value?, oldVal?) => {\r\n    const depsMap = targetMap.get(target);\r\n    if(!depsMap) return;\r\n    const effectSet:any = depsMap.get(key);\r\n    if(effectSet) {\r\n        if(isArray(target) && key === 'length') {\r\n            // state.list.length = 1; [1,2,3] => 1 => 2、3改变了，所以需要重新触发effect\r\n            depsMap.forEach((val, mapKey) => {\r\n                if(mapKey === 'length' || mapKey >= value) {\r\n                    val.forEach(cur => {\r\n                        if(cur !== activeEffect) {\r\n                            console.log(cur);\r\n                            cur.run();\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        } else {\r\n            // 深克隆\r\n            const tmp: any= new Set(effectSet);\r\n            switch(type) {\r\n                case TriggerOpTypes.ADD:\r\n                    // state.list[100] = 100;\r\n                    // 索引变化 => 长度变化;\r\n                    if(isArray(target) && isIntegerKey(key)) {\r\n                        depsMap.get('length').forEach(cur => {\r\n                            if(cur !== activeEffect) {\r\n                                console.log(cur);\r\n                                cur.run();\r\n                            }\r\n                        })\r\n                    }\r\n                    break;\r\n                case TriggerOpTypes.SET:\r\n                    // 修改值：state.list[4] = 4;\r\n                    depsMap.get(key).forEach(cur => {\r\n                        if(cur !== activeEffect) {\r\n                            console.log(cur);\r\n                            cur.run();\r\n                        }\r\n                    })\r\n            }\r\n        }\r\n    }\r\n    console.log(targetMap);\r\n}","/**\r\n * 示例代码：const state = reactive({list: [1,2,3], {name: {a: 1}}})\r\n */\r\nimport { isObject, isEqual, isArray, isIntegerKey, hasOwn } from './../../shared/src/index';\r\nimport { reactive, readonly } from './reactive';\r\nimport { TrackOpTypes, TriggerOpTypes } from './operations';\r\nimport {track, trigger} from './effect'\r\nexport const reactiveHandler = {\r\n    get(target, key, receiver) {\r\n        if(key === \"__isProxy__\") return true;\r\n        const res = Reflect.get(target, key, receiver)\r\n        // 收集依赖\r\n        track(target, key, TrackOpTypes.GET);\r\n        if(isObject(res)) return reactive(res);\r\n        return res;\r\n    },\r\n    set(target, key, value, newValue) {\r\n        const oldVal = target[key]\r\n        const res = Reflect.set(target, key, value, newValue);\r\n        // 触发回调\r\n        // 前者：修改；后者：新增\r\n        const hasKey = isArray(target) && isIntegerKey(key) ? Number(key) < target.length : hasOwn(target, key)\r\n        if(!hasKey) {\r\n            // 新增/删减\r\n            trigger(target, key, TriggerOpTypes.ADD)\r\n        } else {\r\n            // 修改\r\n            if(!isEqual(res, oldVal)) {\r\n                trigger(target, key, TriggerOpTypes.SET)\r\n            }\r\n            \r\n        }\r\n        if(isObject(res)) reactive(res);\r\n    }\r\n};\r\nexport const shallowReactiveHandler = {};\r\nexport const readonlyHandler = {\r\n    get(target, key, receiver){\r\n        const res = Reflect.get(target, key, receiver);\r\n        if(isObject(res)) return readonly(res);\r\n        return res;\r\n    },\r\n    set() {\r\n        console.error('readonly can not be set')\r\n    }\r\n};\r\nexport const shallowReadonlyHandler = {};","// import { isObject } from \"@vue/shared\";\r\nimport { isObject } from \"../../shared/src/index\";\r\nimport {reactiveHandler, shallowReactiveHandler, readonlyHandler, shallowReadonlyHandler} from './baseHandler'\r\n\r\nexport const reactive = (target: any) => {\r\n    return createReactiveObj(target, false, reactiveHandler)\r\n}\r\nexport const shallowReactive = (target: any) => {\r\n    return createReactiveObj(target, false, shallowReactiveHandler)\r\n}\r\n\r\nexport const readonly = (target) => {\r\n    return createReactiveObj(target, true, readonlyHandler)\r\n}\r\nexport const shallowReadonly = (target: any) => {\r\n    return createReactiveObj(target, true, shallowReadonlyHandler)\r\n}\r\n\r\n/**\r\n * \r\n * @param target: 代理的数据\r\n * @param isReadonly：是否只读 \r\n * @param baseHandler：Proxy对应的handler对象\r\n */\r\nconst reactiveMap = new WeakMap();\r\nconst readonlyMap = new WeakMap()\r\nfunction createReactiveObj(target, isReadonly, baseHandler) {\r\n    // 利用get属性也可以处理递归;\r\n    // if(target.__isProxy__) return target;\r\n    if(!isObject(target)) {\r\n        return target;\r\n    }\r\n    const proxyMap = isReadonly ? readonlyMap : reactiveMap;\r\n    if(proxyMap.get(target)) {\r\n        return proxyMap.get(target);\r\n    }\r\n    const proxy = new Proxy(target, baseHandler);\r\n    proxyMap.set(target, proxy);\r\n    return proxy;\r\n}","import { isArray, isEqual, isObject } from \"../../shared/src/index\";\r\nimport { track, trigger } from \"./effect\";\r\nimport { TriggerOpTypes } from \"./operations\";\r\nimport { reactive } from \"./reactive\";\r\n\r\n\r\nfunction toReactive(data) {\r\n    if(isObject(data)) {\r\n        return reactive(data);\r\n    }\r\n    return data;\r\n}\r\nclass Ref {\r\n    rawData: any;\r\n    _value: any;\r\n    constructor(data) {\r\n        this.rawData = data;\r\n        this._value = toReactive(data);\r\n    }\r\n    get value() {\r\n        track(this,'value', 'get')\r\n        return this._value;\r\n    }\r\n    set value(newVal) {\r\n        if(!isEqual(this.rawData, newVal)){\r\n            this._value = toReactive(newVal);\r\n            trigger(this, 'value', TriggerOpTypes.SET, newVal, this.rawData)\r\n            this.rawData = newVal;\r\n        }\r\n    }\r\n}\r\nexport const ref = (data) => {\r\n    return new Ref(data);\r\n}\r\n\r\nclass RefImpl {\r\n    constructor(public target, public key) {\r\n        this.target = target;\r\n        this.key = key;\r\n    }\r\n    get value() {\r\n        // track(this.target[this.key], 'value')\r\n        return this.target[this.key];\r\n    }\r\n    set value(newVal) {\r\n        this.target[this.key] = newVal;\r\n        // trigger(this.target[this.key], 'value', TriggerOpTypes.SET, newVal);\r\n    }\r\n}\r\n\r\nexport const toRef = (target, key) => {\r\n    return new RefImpl(target, key)\r\n}\r\nexport const toRefs = (target) => {\r\n    let res: any = null;\r\n    if(!target.__isProxy__) {\r\n        console.warn('toRefs() need a reactive object');\r\n    };\r\n    res = isArray(target)? new Array(target.length) : {};\r\n    for(const key in target) {\r\n        res[key] = toRef(target, key);\r\n    }\r\n    return res;\r\n}"],"names":[],"mappings":"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"}