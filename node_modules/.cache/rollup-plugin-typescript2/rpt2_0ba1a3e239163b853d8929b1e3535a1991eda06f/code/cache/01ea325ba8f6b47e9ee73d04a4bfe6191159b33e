{"code":"/**\r\n * 示例代码：const state = reactive({list: [1,2,3], {name: {a: 1}}})\r\n */\r\nimport { isObject, isEqual, isArray, isIntegerKey, hasOwn } from './../../shared/src/index';\r\nimport { reactive, readonly } from './reactive';\r\nimport { TrackOpTypes, TriggerOpTypes } from './operations';\r\nimport { track, trigger } from './effect';\r\nexport var reactiveHandler = {\r\n    get: function (target, key, receiver) {\r\n        if (key === \"__isProxy__\")\r\n            return true;\r\n        var res = Reflect.get(target, key, receiver);\r\n        // 收集依赖\r\n        track(target, key, TrackOpTypes.GET);\r\n        if (isObject(res))\r\n            return reactive(res);\r\n        return res;\r\n    },\r\n    set: function (target, key, value, newValue) {\r\n        var oldVal = target[key];\r\n        var res = Reflect.set(target, key, value, newValue);\r\n        // 触发回调\r\n        // 前者：修改；后者：新增\r\n        var hasKey = isArray(target) && isIntegerKey(key) ? Number(key) < target.length : hasOwn(target, key);\r\n        if (!hasKey) {\r\n            // 新增/删减\r\n            trigger(target, key, TriggerOpTypes.ADD);\r\n        }\r\n        else {\r\n            // 修改\r\n            if (!isEqual(res, oldVal)) {\r\n                trigger(target, key, TriggerOpTypes.SET);\r\n            }\r\n        }\r\n        if (isObject(res))\r\n            reactive(res);\r\n    }\r\n};\r\nexport var shallowReactiveHandler = {};\r\nexport var readonlyHandler = {\r\n    get: function (target, key, receiver) {\r\n        var res = Reflect.get(target, key, receiver);\r\n        if (isObject(res))\r\n            return readonly(res);\r\n        return res;\r\n    },\r\n    set: function () {\r\n        console.error('readonly can not be set');\r\n    }\r\n};\r\nexport var shallowReadonlyHandler = {};\r\n//# sourceMappingURL=baseHandler.js.map","references":["D:/frontEnd/Vue3/mini-Vue3/packages/shared/src/index.ts","D:/frontEnd/Vue3/mini-Vue3/packages/reactivity/src/reactive.ts","D:/frontEnd/Vue3/mini-Vue3/packages/reactivity/src/operations.ts","D:/frontEnd/Vue3/mini-Vue3/packages/reactivity/src/effect.ts"],"map":"{\"version\":3,\"file\":\"baseHandler.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/reactivity/src/baseHandler.ts\"],\"names\":[],\"mappings\":\"AAAA;;GAEG;AACH,OAAO,EAAE,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAE,YAAY,EAAE,MAAM,EAAE,MAAM,0BAA0B,CAAC;AAC5F,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,YAAY,CAAC;AAChD,OAAO,EAAE,YAAY,EAAE,cAAc,EAAE,MAAM,cAAc,CAAC;AAC5D,OAAO,EAAC,KAAK,EAAE,OAAO,EAAC,MAAM,UAAU,CAAA;AACvC,MAAM,CAAC,IAAM,eAAe,GAAG;IAC3B,GAAG,YAAC,MAAM,EAAE,GAAG,EAAE,QAAQ;QACrB,IAAG,GAAG,KAAK,aAAa;YAAE,OAAO,IAAI,CAAC;QACtC,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAA;QAC9C,OAAO;QACP,KAAK,CAAC,MAAM,EAAE,GAAG,EAAE,YAAY,CAAC,GAAG,CAAC,CAAC;QACrC,IAAG,QAAQ,CAAC,GAAG,CAAC;YAAE,OAAO,QAAQ,CAAC,GAAG,CAAC,CAAC;QACvC,OAAO,GAAG,CAAC;IACf,CAAC;IACD,GAAG,YAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,QAAQ;QAC5B,IAAM,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,CAAA;QAC1B,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;QACtD,OAAO;QACP,cAAc;QACd,IAAM,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,IAAI,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,CAAA;QACvG,IAAG,CAAC,MAAM,EAAE;YACR,QAAQ;YACR,OAAO,CAAC,MAAM,EAAE,GAAG,EAAE,cAAc,CAAC,GAAG,CAAC,CAAA;SAC3C;aAAM;YACH,KAAK;YACL,IAAG,CAAC,OAAO,CAAC,GAAG,EAAE,MAAM,CAAC,EAAE;gBACtB,OAAO,CAAC,MAAM,EAAE,GAAG,EAAE,cAAc,CAAC,GAAG,CAAC,CAAA;aAC3C;SAEJ;QACD,IAAG,QAAQ,CAAC,GAAG,CAAC;YAAE,QAAQ,CAAC,GAAG,CAAC,CAAC;IACpC,CAAC;CACJ,CAAC;AACF,MAAM,CAAC,IAAM,sBAAsB,GAAG,EAAE,CAAC;AACzC,MAAM,CAAC,IAAM,eAAe,GAAG;IAC3B,GAAG,YAAC,MAAM,EAAE,GAAG,EAAE,QAAQ;QACrB,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAC;QAC/C,IAAG,QAAQ,CAAC,GAAG,CAAC;YAAE,OAAO,QAAQ,CAAC,GAAG,CAAC,CAAC;QACvC,OAAO,GAAG,CAAC;IACf,CAAC;IACD,GAAG;QACC,OAAO,CAAC,KAAK,CAAC,yBAAyB,CAAC,CAAA;IAC5C,CAAC;CACJ,CAAC;AACF,MAAM,CAAC,IAAM,sBAAsB,GAAG,EAAE,CAAC\"}"}
