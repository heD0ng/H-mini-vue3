{"version":3,"file":"runtime-dom.esm-bundler.js","sources":["../src/modules/class.ts","../src/modules/event.ts","../src/modules/attr.ts","../src/patchProps.ts","../src/nodeOps.ts","../../shared/src/index.ts","../../runtime-core/src/createVNode.ts","../../runtime-core/src/apiCreateApp.ts","../../runtime-core/src/componentPublicInstance.ts","../../reactivity/src/operations.ts","../../reactivity/src/effect.ts","../../runtime-core/src/component.ts","../../runtime-core/src/render.ts","../src/index.ts"],"sourcesContent":["export const patchClass = (el, value) => {\r\n    if(!value) value = '';\r\n    el.className = value;\r\n}","export const patchEvent = (el, key, fn) => {\r\n    // vei = vue event invoker\r\n    if(!el._vei) {\r\n        el._vei = {};\r\n    }\r\n    const invokers = el._vei || {};\r\n    if(!fn) {\r\n        if(invokers[key]) {\r\n            const name = key.slice(2).toLowerCase();\r\n            el.removeEventListener(name, invokers[key]);\r\n            delete invokers[key];\r\n        }\r\n    } else {\r\n        if(!invokers[key]) {\r\n            const name = key.slice(2).toLowerCase();\r\n            let invoke = invokers[key] = createInvoker(fn);\r\n            el.addEventListener(name, invoke)\r\n        } else {\r\n            // value保存的是上一次的函数;\r\n            invokers[key].value = fn;\r\n        }\r\n    }\r\n}\r\n\r\nfunction createInvoker(fn) {\r\n    const tmp = (e) => {\r\n        tmp.value(e);\r\n        // fn.call(e);\r\n    }\r\n    tmp.value = fn;\r\n    return tmp;\r\n}","export const patchAttr = (el, key, value = '') => {\r\n    if(!value) el.removeAttribute(key); \r\n    el.setAttribute(key, value);\r\n}","import {patchAttr,patchClass, patchEvent, patchStyle} from './modules/index';\r\nexport const patchProp = (el, key, newVal, oldVal) => {\r\n    switch (key) {\r\n        case 'class':{\r\n            patchClass(el, newVal)\r\n            break;\r\n        }\r\n        case 'style': {\r\n            break;\r\n        }\r\n        default:{\r\n            if (/^on[A-Z]/.test(key)) {\r\n                patchEvent(el, key, newVal);\r\n            } else {\r\n                patchAttr(el, key, newVal);\r\n            }\r\n            break;\r\n        }\r\n            \r\n    }\r\n}","export const nodeOps = {\r\n    createElement: (tagName:string) => {\r\n        return document.createElement(tagName);\r\n    },\r\n    insert: (child, parent, anchor=null) => {\r\n        parent.insertBefore(child, anchor);\r\n    },\r\n    remove: (node) => {\r\n        const parentNode = node.parentNode;\r\n        if (parentNode) {\r\n            parentNode.removeChild(node);\r\n        }\r\n    },\r\n    createTextNode: (text) => {\r\n        return document.createTextNode(text);\r\n    },\r\n    querySelector: (selector) => {\r\n        return document.querySelector(selector);\r\n    },\r\n    setElementText: (el, text) => {\r\n        el.nodeValue = text;\r\n    },\r\n    parentNode: node => node.parentNode,\r\n    nextSibling: node => node.nextSibling,\r\n    setText: (el, text) => {\r\n        el.textContent = text;\r\n    },\r\n} ","export const isObject = (data) => {\r\n    return data && typeof data === 'object';\r\n}\r\n\r\nexport const isEqual = (val, oldVal) => {\r\n    return val === oldVal;\r\n}\r\n\r\nexport const isArray = (val) => {\r\n    return Array.isArray(val)\r\n}\r\n\r\nexport const isFunction = (val) => {\r\n    return typeof val === 'function';\r\n}\r\nexport const isNumber = (val) => {\r\n    return typeof val === 'number';\r\n}\r\nexport const isString = (val) => {\r\n    return typeof val === 'string';\r\n}\r\n// 判断数组的索引\r\nexport const isIntegerKey = (key) => '' + parseInt(key) === key;\r\n\r\nexport const hasOwn = (target, key) => {\r\n    return Object.prototype.hasOwnProperty.call(target, key);\r\n}\r\n\r\nexport * from './shapeFlags';","import { isArray, isObject } from './../../shared/src/index';\r\nimport { ShapeFlags } from \"../../shared/src/shapeFlags\";\r\nimport { isString } from \"../../shared/src/index\";\r\nexport function createVNode(type, props, children = null) {\r\n    let shapeFlag = 0;\r\n\t// div\\p\r\n\tif(isString(type)) {\r\n\t\tshapeFlag = ShapeFlags.ELEMENT;\r\n\t} else if(isObject(type)) {\r\n\t\tshapeFlag = ShapeFlags.STATEFUL_COMPONENT;\r\n\t} else {\r\n        shapeFlag = 0;\r\n    }\r\n\r\n    const vnode = {\r\n        type,\r\n        props,\r\n        children,\r\n        key: props?.key,\r\n        shapeFlag\r\n    }\r\n    normalizeChildren(vnode, children);\r\n    return vnode;\r\n}\r\n\r\nfunction normalizeChildren (vnode, children) {\r\n    let type = 0;\r\n    if(children) {\r\n        if(isArray(children)) {\r\n            type = ShapeFlags.ARRAY_CHILDREN;\r\n        } else if(isString(children)) {\r\n            type = ShapeFlags.TEXT_CHILDREN;\r\n        } else {\r\n            console.log(children);\r\n        }\r\n    }\r\n    vnode.shapeFlag = vnode.shapeFlag | type;\r\n\r\n}\r\n","import { createVNode } from \"./createVNode\";\r\n\r\nexport function apiCreateApp(render) {\r\n    return function createApp (rootComponent, rootProps) {\r\n        let app = {\r\n            mount (container) {\r\n                let vnode: any = createVNode(rootComponent, rootProps);\r\n                render(vnode, container);\r\n                vnode._container = container;\r\n            }\r\n        }\r\n        return app;\r\n    }\r\n}","import { hasOwn } from \"../../shared/src/index\";\r\n\r\nexport const componentPublicInstance: any = {\r\n    get(target, key) {\r\n        const instance = target._;\r\n        const {props, setupState, data} = instance;\r\n        if(hasOwn(setupState, key)) {\r\n            return setupState[key];\r\n        } else if (hasOwn(props, key)) {\r\n            return props[key];\r\n        } else if(hasOwn(data, key)) {\r\n            return data[key];\r\n        }\r\n    },\r\n    set(target, key, value) {\r\n\r\n    }\r\n}","// 操作符\r\nexport enum TrackOpTypes {\r\n    GET = 'get',\r\n    HAS = 'has',\r\n    ITERATE = 'iterate'\r\n}\r\n\r\nexport enum TriggerOpTypes {\r\n    SET = 'set',\r\n    ADD = 'add',\r\n    DELETE = 'delete',\r\n    CLEAR = 'clear'\r\n}","import { isArray, isIntegerKey } from './../../shared/src/index';\r\nimport {TriggerOpTypes} from './operations';\r\nlet activeEffect = null;\r\nlet effectList = []\r\n\r\n/**\r\n * \r\n * @param fn \r\n * @param options : {lazy: true}-lazy为true，默认不执行\r\n * @returns \r\n */\r\nconst createReactiveEffect = (fn, options) => {\r\n    return new ReactiveEffect(fn, options);\r\n}\r\nexport const effect = (fn, options:any = {}) => {\r\n    const effect = createReactiveEffect(fn, options);\r\n    if(!options.lazy){\r\n        effect.run();\r\n    }\r\n    \r\n    return effect;\r\n}\r\n\r\n\r\nclass ReactiveEffect {\r\n    fn: Function;\r\n    options: any;\r\n    deps: Array<any>;\r\n    constructor(fn, options){\r\n        this.fn = fn;\r\n        this.deps = []\r\n        this.options = options;\r\n    }\r\n    run() {\r\n        // state.a++: 避免递归收集\r\n        // 当前的实例effect\r\n        if(!effectList.includes(this)) {\r\n            try {\r\n                // 入栈\r\n                activeEffect = this;\r\n                effectList.push(activeEffect);\r\n                console.log(effectList);\r\n                // cleanActiveEffectDeps(activeEffect);\r\n                return this.fn()\r\n            } finally  {\r\n                // 出栈\r\n                effectList.pop()\r\n                activeEffect = effectList[effectList.length - 1] || null;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction cleanActiveEffectDeps(activeEffect) {\r\n    const {deps} = activeEffect;\r\n    for(const dep of deps) {\r\n        dep.delete(activeEffect)\r\n    }\r\n\r\n    activeEffect.deps.length = 0;\r\n}\r\n\r\nlet targetMap = new WeakMap();\r\nexport function track(target, key, type?) {\r\n    if(!activeEffect) return;\r\n\r\n    let depsMap = targetMap.get(target);\r\n    if(!depsMap) {\r\n        depsMap = new Map()\r\n        targetMap.set(target, depsMap);\r\n        \r\n    }\r\n    let effectSet = depsMap.get(key)\r\n    if(!effectSet) {\r\n        effectSet = new Set();\r\n        depsMap.set(key, effectSet);\r\n    }\r\n    if(!effectSet.has(activeEffect)){\r\n        effectSet.add(activeEffect);\r\n    }\r\n}\r\n/**\r\n * \r\n * @param target \r\n * @param key \r\n * @param type \r\n * @param value \r\n * @param oldVal \r\n * @returns \r\n * depsMap: {\r\n *  0: [e1, e2],\r\n *  length: [e2, e3]\r\n * }\r\n */\r\nexport const trigger = (target, key, type='get', value?, oldVal?) => {\r\n    const depsMap = targetMap.get(target);\r\n    if(!depsMap) return;\r\n    const effectSet:any = depsMap.get(key);\r\n    if(effectSet) {\r\n        if(isArray(target) && key === 'length') {\r\n            // state.list.length = 1; [1,2,3] => 1 => 2、3改变了，所以需要重新触发effect\r\n            depsMap.forEach((val, mapKey) => {\r\n                if(mapKey === 'length' || mapKey >= value) {\r\n                    val.forEach(cur => {\r\n                        if(cur !== activeEffect) {\r\n                            console.log(cur);\r\n                            cur.run();\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        } else {\r\n            // 深克隆\r\n            const tmp: any= new Set(effectSet);\r\n            switch(type) {\r\n                case TriggerOpTypes.ADD:\r\n                    // state.list[100] = 100;\r\n                    // 索引变化 => 长度变化;\r\n                    if(isArray(target) && isIntegerKey(key)) {\r\n                        depsMap.get('length').forEach(cur => {\r\n                            if(cur !== activeEffect) {\r\n                                console.log(cur);\r\n                                cur.run();\r\n                            }\r\n                        })\r\n                    }\r\n                    break;\r\n                case TriggerOpTypes.SET:\r\n                    // 修改值：state.list[4] = 4;\r\n                    depsMap.get(key).forEach(cur => {\r\n                        if(cur !== activeEffect) {\r\n                            console.log(cur);\r\n                            cur.run();\r\n                        }\r\n                    })\r\n            }\r\n        }\r\n    }\r\n    console.log(targetMap);\r\n}","// import { isObject } from '@vue/shared';\r\nimport { isObject } from '../../shared/src/index';\r\nimport { componentPublicInstance } from './componentPublicInstance';\r\nimport { ShapeFlags } from \"../../shared/src/shapeFlags\";\r\nimport { isFunction } from '../../shared/src/index';\r\nimport { effect } from '../../reactivity/src/effect';\r\nexport function mountComponent(vnode, container) {\r\n    const instance = vnode.component = createComponentInstance(vnode);\r\n    return instance;\r\n}\r\n// 创建组件实例\r\nexport function createComponentInstance(vnode) {\r\n    const instance = {\r\n        vnode,\r\n        type: {},\r\n        props: {},\r\n        attrs: {},\r\n        setupState: {},\r\n        ctx: {},\r\n        proxy: {},\r\n        // 判断是否是第一次加载\r\n        isMounted: false\r\n    }\r\n    instance.ctx = {_: instance};\r\n    return instance;\r\n}\r\n\r\n// 解析数据到组件中\r\nexport function setupComponent(instance) {\r\n    const {props, children, type} = instance.vnode;\r\n    instance.type = type;\r\n    instance.props = props;\r\n    instance.children = children;\r\n    let isStateFul = instance.vnode.shapeFlag & ShapeFlags.STATEFUL_COMPONENT;\r\n    if (isStateFul) {\r\n        setupStateComponent(instance)\r\n    }\r\n}\r\n\r\nfunction setupStateComponent(instance) {\r\n    instance.proxy = new Proxy(instance.ctx, componentPublicInstance);\r\n    const setup = instance?.type?.setup || null;\r\n    let context = createContext(instance);\r\n    if (setup) {\r\n        const res = setup(instance.props, context);\r\n        if(isObject(res)) {\r\n            instance.setupState = res;\r\n        } else if(isFunction(res)) {\r\n            instance.render = res;\r\n        } else {\r\n            return console.warn('the return value of setup should be a function or object!');\r\n        }\r\n    }\r\n    finishComponentSetup(instance);\r\n    // instance.render(instance.proxy);\r\n}\r\n// 数据改变重新触发render函数\r\nexport function setupRenderEffect(instance) {\r\n    effect(function() {\r\n        // 判断是不是第一次加载\r\n        if(!instance.isMounted) {\r\n            instance.render.call(instance.proxy, instance.proxy);\r\n        }\r\n    })\r\n}\r\n\r\nexport function createContext(instance) {\r\n    return {\r\n        props: instance.props,\r\n        slots: instance.slots,\r\n        emits: () => {},\r\n        attrs: instance.attrs,\r\n        expose: () => {}\r\n    }\r\n}\r\n\r\nfunction finishComponentSetup(instance) {\r\n    let Component = instance.vnode.component;\r\n    console.log(Component, instance, 5555);\r\n    if(!instance.render) {\r\n        if(!Component.render && Component.template) {\r\n            // 模板编译\r\n            // Component.render = \r\n        }\r\n        instance.render = Component.render;\r\n    }\r\n}","import { apiCreateApp } from \"./apiCreateApp\";\r\nimport { mountComponent, setupComponent, setupRenderEffect } from \"./component\";\r\n\r\nexport function createRender(renderOptionDom) {\r\n    let render = (vnode, container) => {\r\n        patch(null, vnode, container)\r\n    }\r\n    return {\r\n        createApp: apiCreateApp(render)\r\n    }\r\n}\r\n\r\nfunction patch(n1, n2, container) {\r\n    if(!n1) {\r\n        const instance = mountComponent(n2, container);\r\n        setupComponent(instance);\r\n        setupRenderEffect(instance);\r\n    } else {\r\n\r\n    }\r\n}","import { patchProp } from './patchProps';\r\nimport { nodeOps } from './nodeOps';\r\nimport { createRender } from '../../runtime-core/src/render';\r\nconst renderOptionDom = Object.assign({}, {patchProp}, nodeOps);\r\n\r\nexport const createApp = (rootComponent, rootProps) => {\r\n    const app = createRender(renderOptionDom).createApp(rootComponent, rootProps)\r\n    const {mount} = app;\r\n    app.mount = (container) => {\r\n        // 先清空、后挂载\r\n        const el = renderOptionDom.querySelector(container);\r\n        el.innerHTML = '';\r\n        mount(container);\r\n    }\r\n    return app;\r\n}\r\n"],"names":[],"mappings":"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"}